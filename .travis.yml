language: ruby

os:
  - osx
  - linux

before_install:
  - if [[ `uname` == "Linux" ]]; then sh ./setup_travis_linux.sh; fi

install:
  - brew update
  - brew tap homebrew/science
  - brew install pkg-config
  - brew install $(brew deps gcc)
  # Can stay silent for longer than 10 mins if not using bottle.
  - travis_wait brew install gcc
  # Install homebrew/cutest as tap.
  - mkdir -p $(brew --repo)/Library/Taps/travis
  - ln -s $PWD $(brew --repo)/Library/Taps/travis/travis-testtap
  - brew tap --repair

env:
  - PACKAGE=archdefs
  - PACKAGE=sifdecode
  - PACKAGE=cutest
  - PACKAGE=mastsif

script:
  #- brew audit $PACKAGE --strict  # Fails for now b/c head only.
  - brew install -v $PACKAGE --HEAD
  - brew test -v $PACKAGE
